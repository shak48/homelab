# roles/samba/templates/smb.conf.j2

[global]
   workgroup = WORKGROUP
   server string = Samba Server
   netbios name = {{ inventory_hostname }}
   security = user
   map to guest = never
   dns proxy = no

   log file = /var/log/samba/log.%m
   max log size = 1000
   logging = file
   log level = 1

   panic action = /usr/share/samba/panic-action %d
   server role = standalone server
   passdb backend = tdbsam

   obey pam restrictions = yes
   unix password sync = no
   pam password change = yes

   guest account = nobody
   disable spoolss = yes
   min protocol = SMB2
   server min protocol = SMB2

{% for share in samba_shares %}
[{{ share.name }}]
   path = {{ share.path }}
   valid users = {{ share.valid_users }}
   browsable = yes
   writable = yes
   read only = no
   create mask = 0660
   directory mask = 0770

{% endfor %}
