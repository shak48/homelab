---
# Validate presence of required bootstrap packages

- name: Check for required packages
  command: "which {{ item }}"
  loop: "{{ bootstrap_packages }}"
  register: check_packages
  changed_when: false
  ignore_errors: true  # We will handle missing packages explicitly

- name: Fail if any package was not found
  fail:
    msg: "Package '{{ item.item }}' is missing (not found by 'which')."
  when: item.rc != 0
  loop: "{{ check_packages.results }}"
  loop_control:
    label: "{{ item.item }}"

- name: Show detected package paths
  debug:
    msg: "{{ item.item }} => {{ item.stdout }}"
  when: item.rc == 0
  loop: "{{ check_packages.results }}"


